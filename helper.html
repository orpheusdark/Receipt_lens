<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Receipt Lens Setup</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
        }
        /* New Animated Shapes Background */
        .background-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(300deg, #1e1b4b, #4c1d95, #0f172a);
            z-index: -1;
            transition: transform 0.1s ease-out; /* For interactive mouse effect */
        }
        .shape {
            position: absolute;
            display: block;
            list-style: none;
            background: rgba(255, 255, 255, 0.05);
            animation: float 25s linear infinite;
            bottom: -200px; /* Start below the screen */
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .shape.circle { border-radius: 50%; }
        .shape.square { border-radius: 0; }
        .shape.triangle {
            width: 0;
            height: 0;
            background: transparent;
            border-left: 50px solid transparent;
            border-right: 50px solid transparent;
            border-bottom: 100px solid rgba(255, 255, 255, 0.05);
        }

        .shape:nth-child(1){ left: 25%; width: 80px; height: 80px; animation-delay: 0s; }
        .shape:nth-child(2){ left: 10%; width: 30px; height: 30px; animation-delay: 2s; animation-duration: 17s; }
        .shape:nth-child(3){ left: 70%; width: 25px; height: 25px; animation-delay: 4s; }
        .shape:nth-child(4){ left: 40%; width: 60px; height: 60px; animation-delay: 0s; animation-duration: 22s; }
        .shape:nth-child(5){ left: 65%; width: 20px; height: 20px; animation-delay: 1s; }
        .shape:nth-child(6){ left: 75%; width: 110px; height: 110px; animation-delay: 3s; }
        .shape:nth-child(7){ left: 35%; width: 150px; height: 150px; animation-delay: 7s; }
        .shape:nth-child(8){ left: 50%; width: 25px; height: 25px; animation-delay: 15s; animation-duration: 45s; }
        .shape:nth-child(9){ left: 20%; width: 15px; height: 15px; animation-delay: 2s; animation-duration: 35s; }
        .shape:nth-child(10){ left: 85%; width: 160px; height: 160px; animation-delay: 0s; animation-duration: 15s; }
        .shape:nth-child(11){ left: 5%; width: 40px; height: 40px; animation-delay: 5s; animation-duration: 28s; }
        .shape:nth-child(12){ left: 90%; width: 20px; height: 20px; animation-delay: 8s; animation-duration: 20s; }


        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-120vh) rotate(720deg); opacity: 0; }
        }
        /* Fade-in animation for the main card */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-1rem); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in-up {
            animation: fadeIn 0.6s ease-out forwards;
        }
        /* Styling for the checkmark icon */
        .input-check {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            color: #10b981; /* Green */
        }
        .input-valid .input-check {
            opacity: 1;
        }
    </style>
</head>
<body class="p-4 sm:p-8 flex items-center justify-center min-h-screen">
    <div class="background-container">
        <div class="shape circle"></div><div class="shape square"></div><div class="shape circle"></div>
        <div class="shape square"></div><div class="shape circle"></div><div class="shape square"></div>
        <div class="shape circle"></div><div class="shape square"></div><div class="shape circle"></div>
        <div class="shape square"></div><div class="shape circle"></div><div class="shape square"></div>
    </div>
    <div class="max-w-2xl w-full mx-auto bg-white/90 backdrop-blur-xl p-6 sm:p-8 rounded-2xl shadow-2xl fade-in-up">
        <div class="text-center">
            <h1 class="text-2xl sm:text-3xl font-bold text-gray-800">Welcome to Receipt Lens!</h1>
            <p class="mt-2 text-gray-600">Let's get you set up. This is a one-time process to securely link your own Google services.</p>
        </div>

        <hr class="my-6">

        <!-- Step 1 -->
        <div class="step-section space-y-4">
            <div class="flex items-center space-x-3">
                <div class="flex-shrink-0 bg-indigo-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold">1</div>
                <h2 class="text-xl font-bold text-gray-700">Get Your Gemini API Key ðŸ§ </h2>
            </div>
            <ol class="list-decimal list-inside ml-4 space-y-2 text-gray-600">
                <li><a href="https://aistudio.google.com/app/apikey" target="_blank" class="text-blue-600 hover:underline">Open Google AI Studio in a new tab.</a></li>
                <li>Click <strong>"Create API key in new project"</strong>.</li>
                <li>Copy the key it gives you and paste it below.</li>
            </ol>
            <div class="relative">
                <input type="password" id="gemini-key" placeholder="Paste your Gemini API Key here" class="mt-2 w-full p-3 border rounded-md pr-10">
                <svg class="input-check w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
            </div>
        </div>

        <hr class="my-6">

        <!-- Step 2 -->
        <div class="step-section space-y-4">
            <div class="flex items-center space-x-3">
                <div class="flex-shrink-0 bg-indigo-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold">2</div>
                <h2 class="text-xl font-bold text-gray-700">Get Your Google Sheet ID ðŸ“Š</h2>
            </div>
            <ol class="list-decimal list-inside ml-4 space-y-2 text-gray-600">
                <li><a href="https://sheets.new" target="_blank" class="text-blue-600 hover:underline">Create a new Google Sheet.</a></li>
                <li>Rename the sheet (the tab at the bottom) to exactly <strong>Receipt</strong>.</li>
                <li>Copy the long ID from the sheet's URL and paste it below. (e.g., .../d/THIS_IS_THE_ID/edit...)</li>
            </ol>
            <div class="relative">
                <input type="text" id="sheet-id" placeholder="Paste your Google Sheet ID here" class="mt-2 w-full p-3 border rounded-md pr-10">
                <svg class="input-check w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
            </div>
        </div>
        
        <hr class="my-6">
        
        <!-- Step 3 -->
        <div class="step-section space-y-4">
            <div class="flex items-center space-x-3">
                <div class="flex-shrink-0 bg-indigo-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold">3</div>
                <h2 class="text-xl font-bold text-gray-700">Get Your Google Client ID ðŸ”‘</h2>
            </div>
            <ol class="list-decimal list-inside ml-4 space-y-2 text-gray-600">
                <li><a href="https://console.cloud.google.com/apis/credentials" target="_blank" class="text-blue-600 hover:underline">Open the Google Cloud Credentials page.</a></li>
                <li>Click <strong>"+ CREATE CREDENTIALS"</strong> and select <strong>"OAuth client ID"</strong>.</li>
                <li>For "Application type", select <strong>"Web application"</strong>.</li>
                <li>Under "Authorized JavaScript origins", click <strong>"+ ADD URI"</strong> and enter the URL where you are hosting Receipt Lens (e.g., `https://your-username.github.io`).</li>
                <li>Click <strong>"CREATE"</strong>, then copy the <strong>Client ID</strong> and paste it below.</li>
            </ol>
            <div class="relative">
                <input type="text" id="client-id" placeholder="Paste your Google Client ID here" class="mt-2 w-full p-3 border rounded-md pr-10">
                <svg class="input-check w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
            </div>
        </div>

        <button id="save-btn" class="mt-8 w-full bg-green-600 text-white font-bold py-3 rounded-lg hover:bg-green-700 transition-all duration-300 ease-in-out transform hover:scale-105 active:scale-95 disabled:bg-gray-400 disabled:cursor-not-allowed" disabled>
            Save & Start Using Receipt Lens
        </button>
    </div>

    <script>
        const geminiKeyInput = document.getElementById('gemini-key');
        const sheetIdInput = document.getElementById('sheet-id');
        const clientIdInput = document.getElementById('client-id');
        const saveBtn = document.getElementById('save-btn');
        const background = document.querySelector('.background-container');

        // Interactive background effect
        document.addEventListener('mousemove', (e) => {
            const { clientX, clientY } = e;
            const { innerWidth, innerHeight } = window;
            const x = (clientX / innerWidth - 0.5) * 2; // -1 to 1
            const y = (clientY / innerHeight - 0.5) * 2; // -1 to 1
            
            background.style.transform = `translateX(${x * -10}px) translateY(${y * -10}px)`;
        });

        // Function to check if all inputs are filled and enable the save button
        function validateInputs() {
            const geminiKey = geminiKeyInput.value.trim();
            const sheetId = sheetIdInput.value.trim();
            const clientId = clientIdInput.value.trim();

            geminiKeyInput.parentElement.classList.toggle('input-valid', geminiKey.length > 0);
            sheetIdInput.parentElement.classList.toggle('input-valid', sheetId.length > 0);
            clientIdInput.parentElement.classList.toggle('input-valid', clientId.length > 0);

            if (geminiKey && sheetId && clientId) {
                saveBtn.disabled = false;
            } else {
                saveBtn.disabled = true;
            }
        }

        geminiKeyInput.addEventListener('input', validateInputs);
        sheetIdInput.addEventListener('input', validateInputs);
        clientIdInput.addEventListener('input', validateInputs);

        // Save button functionality
        saveBtn.addEventListener('click', () => {
            const creds = {
                geminiKey: geminiKeyInput.value.trim(),
                sheetId: sheetIdInput.value.trim(),
                clientId: clientIdInput.value.trim()
            };

            const mainAppUrl = "https://orpheusdark.github.io/Receipt_lens/"; 
            
            const redirectUrl = `${mainAppUrl}#credentials=${btoa(JSON.stringify(creds))}`;
            
            window.location.href = redirectUrl;
        });
    </script>
</body>
</html>
